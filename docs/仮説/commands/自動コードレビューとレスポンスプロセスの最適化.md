# 自動コードレビューとレスポンスプロセスの最適化

## 仮説の概要
人間を介さない自動コードレビューシステムを構築し、開発ルールに沿った品質を保ちながら、レビューへの対応を効率化する。Claude Code Actionによる自動レビューとreply-reviewコマンドの連携を最適化することで、品質と効率の両立を実現する。

## 現状の課題

### 1. 自動レビューの品質問題
- **オーバーテスト**: 過剰なテスト要求による開発速度の低下
- **ルール適用の不一致**: プロジェクト固有のルールが反映されない
- **コンテキスト理解不足**: 変更の意図を理解せずに機械的なレビュー

### 2. レビュー対応プロセスの問題
- **GraphQLクエリーの失敗**: リゾルブ状態確認が頻繁に失敗
- **返信忘れ**: 長文指示による認識ミス
- **Git操作の複雑性**: 複数のAPIとツールの組み合わせ

### 3. 効率性の問題
- **手動介入の必要性**: 自動化が不完全で人間の確認が必要
- **反復作業**: 同じようなレビューコメントへの対応の繰り返し

## ワークフローの図解

### 1. 現状のワークフロー（変更前）

```mermaid
graph TD
    A[開発開始] --> B{用途選択}
    B -->|新機能| C[/yolo-bdd-rgbc]
    B -->|その他| D[/orchestrator]
    
    C --> E[TDD開発]
    D --> F[タスク実行]
    
    E --> G[コミット・プッシュ]
    F --> G
    
    G --> H[PR作成<br/>（一括実行）]
    
    H --> I[Claude Code Action<br/>自動レビュー起動]
    
    I --> J[インラインコメント<br/>投稿]
    
    J --> K[開発者が確認]
    
    K --> L[/reply-review 実行]
    
    L --> M[MCPでコメント取得]
    M --> N[GraphQLでリゾルブ確認]
    N --> O[修正実施]
    O --> P[テスト実行]
    P --> Q[各コメントに返信]
    Q --> R[コミット・プッシュ]
    
    R --> S{CI結果}
    S -->|失敗| T[調整作業]
    S -->|成功| U[完了]
    T --> L
    
    style J fill:#f9f,stroke:#333,stroke-width:2px
    style L fill:#bbf,stroke:#333,stroke-width:2px
```

### 2. 改善されたワークフロー（変更後）

```mermaid
graph TD
    A[開発開始] --> B{用途選択}
    B -->|新機能| C[/yolo-bdd-rgbc]
    B -->|その他| D[/orchestrator]
    
    C --> E[TDD開発]
    D --> F[タスク実行]
    
    E --> G[コミット・プッシュ]
    F --> G
    
    G --> H[PR作成]
    
    H --> I[Claude Code Action<br/>ルールベースレビュー]
    
    I --> J[インラインコメント]
    
    J --> K[/reply-review<br/>（簡略版）]
    
    K --> L[git-operations<br/>エージェント]
    K --> M[review-responder<br/>エージェント]
    
    L --> N[API操作<br/>（GitHub CLI）]
    M --> O[修正・返信<br/>（確実な実行）]
    
    N --> P[統合処理]
    O --> P
    
    P --> Q[プッシュ]
    
    Q --> R{CI結果}
    R -->|成功| S[完了]
    R -->|失敗| T[自動調整]
    T --> K
    
    style J fill:#f9f,stroke:#333,stroke-width:2px
    style K fill:#9f9,stroke:#333,stroke-width:2px
    style L fill:#99f,stroke:#333,stroke-width:2px
    style M fill:#99f,stroke:#333,stroke-width:2px
```